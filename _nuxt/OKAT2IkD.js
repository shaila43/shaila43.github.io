import{_ as Pt}from"./C6ET2b31.js";import{p as Lt,j as st,k as j,l as Ft,m as Gt,n as Rt,c as N,a as m,b as Ne,q as Pe,s as S,v as Le,F as Ut,r as Tt,w as Fe,T as Dt,o as P,d as Ge,t as ne,x as Ot}from"#entry";const Bt=Lt("/img/multi-injected-provider-discovery-eip-6963.jpeg"),Vt={name:"unwrap",root:e=>{const r=e.children[0],t=r.children[0];return{type:"root",children:[{...t,properties:{...r.properties,...t.properties}}]}}};function Q(e){if([...e].length!==1)throw new Error(`Expected "${e}" to be a single code point`);return e.codePointAt(0)}function Ht(e,r,t){return e.has(r)||e.set(r,t),e.get(r)}const $e=new Set(["alnum","alpha","ascii","blank","cntrl","digit","graph","lower","print","punct","space","upper","word","xdigit"]),k=String.raw;function J(e,r){if(e==null)throw new Error(r??"Value expected");return e}const ot=k`\[\^?`,at=`c.? | C(?:-.?)?|${k`[pP]\{(?:\^?[-\x20_]*[A-Za-z][-\x20\w]*\})?`}|${k`x[89A-Fa-f]\p{AHex}(?:\\x[89A-Fa-f]\p{AHex})*`}|${k`u(?:\p{AHex}{4})? | x\{[^\}]*\}? | x\p{AHex}{0,2}`}|${k`o\{[^\}]*\}?`}|${k`\d{1,3}`}`,Ae=/[?*+][?+]?|\{(?:\d+(?:,\d*)?|,\d+)\}\??/,se=new RegExp(k`
  \\ (?:
    ${at}
    | [gk]<[^>]*>?
    | [gk]'[^']*'?
    | .
  )
  | \( (?:
    \? (?:
      [:=!>({]
      | <[=!]
      | <[^>]*>
      | '[^']*'
      | ~\|?
      | #(?:[^)\\]|\\.?)*
      | [^:)]*[:)]
    )?
    | \*[^\)]*\)?
  )?
  | (?:${Ae.source})+
  | ${ot}
  | .
`.replace(/\s+/g,""),"gsu"),de=new RegExp(k`
  \\ (?:
    ${at}
    | .
  )
  | \[:(?:\^?\p{Alpha}+|\^):\]
  | ${ot}
  | &&
  | .
`.replace(/\s+/g,""),"gsu");function zt(e,r={}){const t={flags:"",...r,rules:{captureGroup:!1,singleline:!1,...r.rules}};if(typeof e!="string")throw new Error("String expected as pattern");const n=ur(t.flags),o=[n.extended],s={captureGroup:t.rules.captureGroup,getCurrentModX(){return o.at(-1)},numOpenGroups:0,popModX(){o.pop()},pushModX(p){o.push(p)},replaceCurrentModX(p){o[o.length-1]=p},singleline:t.rules.singleline};let a=[],i;for(se.lastIndex=0;i=se.exec(e);){const p=jt(s,e,i[0],se.lastIndex);p.tokens?a.push(...p.tokens):p.token&&a.push(p.token),p.lastIndex!==void 0&&(se.lastIndex=p.lastIndex)}const l=[];let c=0;a.filter(p=>p.type==="GroupOpen").forEach(p=>{p.kind==="capturing"?p.number=++c:p.raw==="("&&l.push(p)}),c||l.forEach((p,u)=>{p.kind="capturing",p.number=u+1});const d=c||l.length;return{tokens:a.map(p=>p.type==="EscapedNumber"?pr(p,d):p).flat(),flags:n}}function jt(e,r,t,n){const[o,s]=t;if(t==="["||t==="[^"){const a=Wt(r,t,n);return{tokens:a.tokens,lastIndex:a.lastIndex}}if(o==="\\"){if("AbBGyYzZ".includes(s))return{token:Re(t,t)};if(/^\\g[<']/.test(t)){if(!/^\\g(?:<[^>]+>|'[^']+')$/.test(t))throw new Error(`Invalid group name "${t}"`);return{token:rr(t)}}if(/^\\k[<']/.test(t)){if(!/^\\k(?:<[^>]+>|'[^']+')$/.test(t))throw new Error(`Invalid group name "${t}"`);return{token:lt(t)}}if(s==="K")return{token:ut("keep",t)};if(s==="N"||s==="R")return{token:B("newline",t,{negate:s==="N"})};if(s==="O")return{token:B("any",t)};if(s==="X")return{token:B("text_segment",t)};const a=it(t,{inCharClass:!1});return Array.isArray(a)?{tokens:a}:{token:a}}if(o==="("){if(s==="*")return{token:ar(t)};if(t==="(?{")throw new Error(`Unsupported callout "${t}"`);if(t.startsWith("(?#")){if(r[n]!==")")throw new Error('Unclosed comment group "(?#"');return{lastIndex:n+1}}if(/^\(\?[-imx]+[:)]$/.test(t))return{token:or(t,e)};if(e.pushModX(e.getCurrentModX()),e.numOpenGroups++,t==="("&&!e.captureGroup||t==="(?:")return{token:Z("group",t)};if(t==="(?>")return{token:Z("atomic",t)};if(t==="(?="||t==="(?!"||t==="(?<="||t==="(?<!")return{token:Z(t[2]==="<"?"lookbehind":"lookahead",t,{negate:t.endsWith("!")})};if(t==="("&&e.captureGroup||t.startsWith("(?<")&&t.endsWith(">")||t.startsWith("(?'")&&t.endsWith("'"))return{token:Z("capturing",t,{...t!=="("&&{name:t.slice(3,-1)}})};if(t.startsWith("(?~")){if(t==="(?~|")throw new Error(`Unsupported absence function kind "${t}"`);return{token:Z("absence_repeater",t)}}throw t==="(?("?new Error(`Unsupported conditional "${t}"`):new Error(`Invalid or unsupported group option "${t}"`)}if(t===")"){if(e.popModX(),e.numOpenGroups--,e.numOpenGroups<0)throw new Error('Unmatched ")"');return{token:Yt(t)}}if(e.getCurrentModX()){if(t==="#"){const a=r.indexOf(`
`,n);return{lastIndex:a===-1?r.length:a}}if(/^\s$/.test(t)){const a=/\s+/y;return a.lastIndex=n,{lastIndex:a.exec(r)?a.lastIndex:n}}}if(t===".")return{token:B("dot",t)};if(t==="^"||t==="$"){const a=e.singleline?{"^":k`\A`,$:k`\Z`}[t]:t;return{token:Re(a,t)}}return t==="|"?{token:Zt(t)}:Ae.test(t)?{tokens:dr(t)}:{token:G(Q(t),t)}}function Wt(e,r,t){const n=[Ue(r[1]==="^",r)];let o=1,s;for(de.lastIndex=t;s=de.exec(e);){const a=s[0];if(a[0]==="["&&a[1]!==":")o++,n.push(Ue(a[1]==="^",a));else if(a==="]"){if(n.at(-1).type==="CharacterClassOpen")n.push(G(93,a));else if(o--,n.push(qt(a)),!o)break}else{const i=Xt(a);Array.isArray(i)?n.push(...i):n.push(i)}}return{tokens:n,lastIndex:de.lastIndex||e.length}}function Xt(e){if(e[0]==="\\")return it(e,{inCharClass:!0});if(e[0]==="["){const r=/\[:(?<negate>\^?)(?<name>[a-z]+):\]/.exec(e);if(!r||!$e.has(r.groups.name))throw new Error(`Invalid POSIX class "${e}"`);return B("posix",e,{value:r.groups.name,negate:!!r.groups.negate})}return e==="-"?Qt(e):e==="&&"?Jt(e):G(Q(e),e)}function it(e,{inCharClass:r}){const t=e[1];if(t==="c"||t==="C")return sr(e);if("dDhHsSwW".includes(t))return ir(e);if(e.startsWith(k`\o{`))throw new Error(`Incomplete, invalid, or unsupported octal code point "${e}"`);if(/^\\[pP]\{/.test(e)){if(e.length===3)throw new Error(`Incomplete or invalid Unicode property "${e}"`);return lr(e)}if(new RegExp("^\\\\x[89A-Fa-f]\\p{AHex}","u").test(e))try{const n=e.split(/\\x/).slice(1).map(a=>parseInt(a,16)),o=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}).decode(new Uint8Array(n)),s=new TextEncoder;return[...o].map(a=>{const i=[...s.encode(a)].map(l=>`\\x${l.toString(16)}`).join("");return G(Q(a),i)})}catch{throw new Error(`Multibyte code "${e}" incomplete or invalid in Oniguruma`)}if(t==="u"||t==="x")return G(cr(e),e);if(Te.has(t))return G(Te.get(t),e);if(/\d/.test(t))return Kt(r,e);if(e==="\\")throw new Error(k`Incomplete escape "\"`);if(t==="M")throw new Error(`Unsupported meta "${e}"`);if([...e].length===2)return G(e.codePointAt(1),e);throw new Error(`Unexpected escape "${e}"`)}function Zt(e){return{type:"Alternator",raw:e}}function Re(e,r){return{type:"Assertion",kind:e,raw:r}}function lt(e){return{type:"Backreference",raw:e}}function G(e,r){return{type:"Character",value:e,raw:r}}function qt(e){return{type:"CharacterClassClose",raw:e}}function Qt(e){return{type:"CharacterClassHyphen",raw:e}}function Jt(e){return{type:"CharacterClassIntersector",raw:e}}function Ue(e,r){return{type:"CharacterClassOpen",negate:e,raw:r}}function B(e,r,t={}){return{type:"CharacterSet",kind:e,...t,raw:r}}function ut(e,r,t={}){return e==="keep"?{type:"Directive",kind:e,raw:r}:{type:"Directive",kind:e,flags:J(t.flags),raw:r}}function Kt(e,r){return{type:"EscapedNumber",inCharClass:e,raw:r}}function Yt(e){return{type:"GroupClose",raw:e}}function Z(e,r,t={}){return{type:"GroupOpen",kind:e,...t,raw:r}}function er(e,r,t,n){return{type:"NamedCallout",kind:e,tag:r,arguments:t,raw:n}}function tr(e,r,t,n){return{type:"Quantifier",kind:e,min:r,max:t,raw:n}}function rr(e){return{type:"Subroutine",raw:e}}const nr=new Set(["COUNT","CMP","ERROR","FAIL","MAX","MISMATCH","SKIP","TOTAL_COUNT"]),Te=new Map([["a",7],["b",8],["e",27],["f",12],["n",10],["r",13],["t",9],["v",11]]);function sr(e){const r=e[1]==="c"?e[2]:e[3];if(!r||!/[A-Za-z]/.test(r))throw new Error(`Unsupported control character "${e}"`);return G(Q(r.toUpperCase())-64,e)}function or(e,r){let{on:t,off:n}=/^\(\?(?<on>[imx]*)(?:-(?<off>[-imx]*))?/.exec(e).groups;n??="";const o=(r.getCurrentModX()||t.includes("x"))&&!n.includes("x"),s=Oe(t),a=Oe(n),i={};if(s&&(i.enable=s),a&&(i.disable=a),e.endsWith(")"))return r.replaceCurrentModX(o),ut("flags",e,{flags:i});if(e.endsWith(":"))return r.pushModX(o),r.numOpenGroups++,Z("group",e,{...(s||a)&&{flags:i}});throw new Error(`Unexpected flag modifier "${e}"`)}function ar(e){const r=/\(\*(?<name>[A-Za-z_]\w*)?(?:\[(?<tag>(?:[A-Za-z_]\w*)?)\])?(?:\{(?<args>[^}]*)\})?\)/.exec(e);if(!r)throw new Error(`Incomplete or invalid named callout "${e}"`);const{name:t,tag:n,args:o}=r.groups;if(!t)throw new Error(`Invalid named callout "${e}"`);if(n==="")throw new Error(`Named callout tag with empty value not allowed "${e}"`);const s=o?o.split(",").filter(d=>d!=="").map(d=>/^[+-]?\d+$/.test(d)?+d:d):[],[a,i,l]=s,c=nr.has(t)?t.toLowerCase():"custom";switch(c){case"fail":case"mismatch":case"skip":if(s.length>0)throw new Error(`Named callout arguments not allowed "${s}"`);break;case"error":if(s.length>1)throw new Error(`Named callout allows only one argument "${s}"`);if(typeof a=="string")throw new Error(`Named callout argument must be a number "${a}"`);break;case"max":if(!s.length||s.length>2)throw new Error(`Named callout must have one or two arguments "${s}"`);if(typeof a=="string"&&!/^[A-Za-z_]\w*$/.test(a))throw new Error(`Named callout argument one must be a tag or number "${a}"`);if(s.length===2&&(typeof i=="number"||!/^[<>X]$/.test(i)))throw new Error(`Named callout optional argument two must be '<', '>', or 'X' "${i}"`);break;case"count":case"total_count":if(s.length>1)throw new Error(`Named callout allows only one argument "${s}"`);if(s.length===1&&(typeof a=="number"||!/^[<>X]$/.test(a)))throw new Error(`Named callout optional argument must be '<', '>', or 'X' "${a}"`);break;case"cmp":if(s.length!==3)throw new Error(`Named callout must have three arguments "${s}"`);if(typeof a=="string"&&!/^[A-Za-z_]\w*$/.test(a))throw new Error(`Named callout argument one must be a tag or number "${a}"`);if(typeof i=="number"||!/^(?:[<>!=]=|[<>])$/.test(i))throw new Error(`Named callout argument two must be '==', '!=', '>', '<', '>=', or '<=' "${i}"`);if(typeof l=="string"&&!/^[A-Za-z_]\w*$/.test(l))throw new Error(`Named callout argument three must be a tag or number "${l}"`);break;case"custom":throw new Error(`Undefined callout name "${t}"`);default:throw new Error(`Unexpected named callout kind "${c}"`)}return er(c,n??null,o?.split(",")??null,e)}function De(e){let r=null,t,n;if(e[0]==="{"){const{minStr:o,maxStr:s}=/^\{(?<minStr>\d*)(?:,(?<maxStr>\d*))?/.exec(e).groups,a=1e5;if(+o>a||s&&+s>a)throw new Error("Quantifier value unsupported in Oniguruma");if(t=+o,n=s===void 0?+o:s===""?1/0:+s,t>n&&(r="possessive",[t,n]=[n,t]),e.endsWith("?")){if(r==="possessive")throw new Error('Unsupported possessive interval quantifier chain with "?"');r="lazy"}else r||(r="greedy")}else t=e[0]==="+"?1:0,n=e[0]==="?"?1:1/0,r=e[1]==="+"?"possessive":e[1]==="?"?"lazy":"greedy";return tr(r,t,n,e)}function ir(e){const r=e[1].toLowerCase();return B({d:"digit",h:"hex",s:"space",w:"word"}[r],e,{negate:e[1]!==r})}function lr(e){const{p:r,neg:t,value:n}=/^\\(?<p>[pP])\{(?<neg>\^?)(?<value>[^}]+)/.exec(e).groups;return B("property",e,{value:n,negate:r==="P"&&!t||r==="p"&&!!t})}function Oe(e){const r={};return e.includes("i")&&(r.ignoreCase=!0),e.includes("m")&&(r.dotAll=!0),e.includes("x")&&(r.extended=!0),Object.keys(r).length?r:null}function ur(e){const r={ignoreCase:!1,dotAll:!1,extended:!1,digitIsAscii:!1,posixIsAscii:!1,spaceIsAscii:!1,wordIsAscii:!1,textSegmentMode:null};for(let t=0;t<e.length;t++){const n=e[t];if(!"imxDPSWy".includes(n))throw new Error(`Invalid flag "${n}"`);if(n==="y"){if(!/^y{[gw]}/.test(e.slice(t)))throw new Error('Invalid or unspecified flag "y" mode');r.textSegmentMode=e[t+2]==="g"?"grapheme":"word",t+=3;continue}r[{i:"ignoreCase",m:"dotAll",x:"extended",D:"digitIsAscii",P:"posixIsAscii",S:"spaceIsAscii",W:"wordIsAscii"}[n]]=!0}return r}function cr(e){if(new RegExp("^(?:\\\\u(?!\\p{AHex}{4})|\\\\x(?!\\p{AHex}{1,2}|\\{\\p{AHex}{1,8}\\}))","u").test(e))throw new Error(`Incomplete or invalid escape "${e}"`);const r=e[2]==="{"?new RegExp("^\\\\x\\{\\s*(?<hex>\\p{AHex}+)","u").exec(e).groups.hex:e.slice(2);return parseInt(r,16)}function pr(e,r){const{raw:t,inCharClass:n}=e,o=t.slice(1);if(!n&&(o!=="0"&&o.length===1||o[0]!=="0"&&+o<=r))return[lt(t)];const s=[],a=o.match(/^[0-7]+|\d/g);for(let i=0;i<a.length;i++){const l=a[i];let c;if(i===0&&l!=="8"&&l!=="9"){if(c=parseInt(l,8),c>127)throw new Error(k`Octal encoded byte above 177 unsupported "${t}"`)}else c=Q(l);s.push(G(c,(i===0?"\\":"")+l))}return s}function dr(e){const r=[],t=new RegExp(Ae,"gy");let n;for(;n=t.exec(e);){const o=n[0];if(o[0]==="{"){const s=/^\{(?<min>\d+),(?<max>\d+)\}\??$/.exec(o);if(s){const{min:a,max:i}=s.groups;if(+a>+i&&o.endsWith("?")){t.lastIndex--,r.push(De(o.slice(0,-1)));continue}}}r.push(De(o))}return r}function ct(e,r){if(!Array.isArray(e.body))throw new Error("Expected node with body array");if(e.body.length!==1)return!1;const t=e.body[0];return!r||Object.keys(r).every(n=>r[n]===t[n])}function fr(e){return gr.has(e.type)}const gr=new Set(["AbsenceFunction","Backreference","CapturingGroup","Character","CharacterClass","CharacterSet","Group","Quantifier","Subroutine"]);function pt(e,r={}){const t={flags:"",normalizeUnknownPropertyNames:!1,skipBackrefValidation:!1,skipLookbehindValidation:!1,skipPropertyNameValidation:!1,unicodePropertyMap:null,...r,rules:{captureGroup:!1,singleline:!1,...r.rules}},n=zt(e,{flags:t.flags,rules:{captureGroup:t.rules.captureGroup,singleline:t.rules.singleline}}),o=(u,g)=>{const f=n.tokens[s.nextIndex];switch(s.parent=u,s.nextIndex++,f.type){case"Alternator":return V();case"Assertion":return hr(f);case"Backreference":return mr(f,s);case"Character":return ue(f.value,{useLastValid:!!g.isCheckingRangeEnd});case"CharacterClassHyphen":return wr(f,s,g);case"CharacterClassOpen":return yr(f,s,g);case"CharacterSet":return br(f,s);case"Directive":return $r(f.kind,{flags:f.flags});case"GroupOpen":return Cr(f,s,g);case"NamedCallout":return _r(f.kind,f.tag,f.arguments);case"Quantifier":return xr(f,s);case"Subroutine":return kr(f,s);default:throw new Error(`Unexpected token type "${f.type}"`)}},s={capturingGroups:[],hasNumberedRef:!1,namedGroupsByName:new Map,nextIndex:0,normalizeUnknownPropertyNames:t.normalizeUnknownPropertyNames,parent:null,skipBackrefValidation:t.skipBackrefValidation,skipLookbehindValidation:t.skipLookbehindValidation,skipPropertyNameValidation:t.skipPropertyNameValidation,subroutines:[],tokens:n.tokens,unicodePropertyMap:t.unicodePropertyMap,walk:o},a=Sr(Ar(n.flags));let i=a.body[0];for(;s.nextIndex<n.tokens.length;){const u=o(i,{});u.type==="Alternative"?(a.body.push(u),i=u):i.body.push(u)}const{capturingGroups:l,hasNumberedRef:c,namedGroupsByName:d,subroutines:p}=s;if(c&&d.size&&!t.rules.captureGroup)throw new Error("Numbered backref/subroutine not allowed when using named capture");for(const{ref:u}of p)if(typeof u=="number"){if(u>l.length)throw new Error("Subroutine uses a group number that's not defined");u&&(l[u-1].isSubroutined=!0)}else if(d.has(u)){if(d.get(u).length>1)throw new Error(k`Subroutine uses a duplicate group name "\g<${u}>"`);d.get(u)[0].isSubroutined=!0}else throw new Error(k`Subroutine uses a group name that's not defined "\g<${u}>"`);return a}function hr({kind:e}){return be(J({"^":"line_start",$:"line_end","\\A":"string_start","\\b":"word_boundary","\\B":"word_boundary","\\G":"search_start","\\y":"text_segment_boundary","\\Y":"text_segment_boundary","\\z":"string_end","\\Z":"string_end_newline"}[e],`Unexpected assertion kind "${e}"`),{negate:e===k`\B`||e===k`\Y`})}function mr({raw:e},r){const t=/^\\k[<']/.test(e),n=t?e.slice(3,-1):e.slice(1),o=(s,a=!1)=>{const i=r.capturingGroups.length;let l=!1;if(s>i)if(r.skipBackrefValidation)l=!0;else throw new Error(`Not enough capturing groups defined to the left "${e}"`);return r.hasNumberedRef=!0,Ce(a?i+1-s:s,{orphan:l})};if(t){const s=/^(?<sign>-?)0*(?<num>[1-9]\d*)$/.exec(n);if(s)return o(+s.groups.num,!!s.groups.sign);if(/[-+]/.test(n))throw new Error(`Invalid backref name "${e}"`);if(!r.namedGroupsByName.has(n))throw new Error(`Group name not defined to the left "${e}"`);return Ce(n)}return o(+n)}function wr(e,r,t){const{tokens:n,walk:o}=r,s=r.parent,a=s.body.at(-1),i=n[r.nextIndex];if(!t.isCheckingRangeEnd&&a&&a.type!=="CharacterClass"&&a.type!=="CharacterClassRange"&&i&&i.type!=="CharacterClassOpen"&&i.type!=="CharacterClassClose"&&i.type!=="CharacterClassIntersector"){const l=o(s,{...t,isCheckingRangeEnd:!0});if(a.type==="Character"&&l.type==="Character")return s.body.pop(),Er(a,l);throw new Error("Invalid character class range")}return ue(Q("-"))}function yr({negate:e},r,t){const{tokens:n,walk:o}=r,s=n[r.nextIndex],a=[ie()];let i=He(s);for(;i.type!=="CharacterClassClose";){if(i.type==="CharacterClassIntersector")a.push(ie()),r.nextIndex++;else{const c=a.at(-1);c.body.push(o(c,t))}i=He(n[r.nextIndex],s)}const l=ie({negate:e});return a.length===1?l.body=a[0].body:(l.kind="intersection",l.body=a.map(c=>c.body.length===1?c.body[0]:c)),r.nextIndex++,l}function br({kind:e,negate:r,value:t},n){const{normalizeUnknownPropertyNames:o,skipPropertyNameValidation:s,unicodePropertyMap:a}=n;if(e==="property"){const i=ce(t);if($e.has(i)&&!a?.has(i))e="posix",t=i;else return q(t,{negate:r,normalizeUnknownPropertyNames:o,skipPropertyNameValidation:s,unicodePropertyMap:a})}return e==="posix"?Ir(t,{negate:r}):xe(e,{negate:r})}function Cr(e,r,t){const{tokens:n,capturingGroups:o,namedGroupsByName:s,skipLookbehindValidation:a,walk:i}=r,l=Mr(e),c=l.type==="AbsenceFunction",d=Ve(l),p=d&&l.negate;if(l.type==="CapturingGroup"&&(o.push(l),l.name&&Ht(s,l.name,[]).push(l)),c&&t.isInAbsenceFunction)throw new Error("Nested absence function not supported by Oniguruma");let u=ze(n[r.nextIndex]);for(;u.type!=="GroupClose";){if(u.type==="Alternator")l.body.push(V()),r.nextIndex++;else{const g=l.body.at(-1),f=i(g,{...t,isInAbsenceFunction:t.isInAbsenceFunction||c,isInLookbehind:t.isInLookbehind||d,isInNegLookbehind:t.isInNegLookbehind||p});if(g.body.push(f),(d||t.isInLookbehind)&&!a){const w="Lookbehind includes a pattern not allowed by Oniguruma";if(p||t.isInNegLookbehind){if(Be(f)||f.type==="CapturingGroup")throw new Error(w)}else if(Be(f)||Ve(f)&&f.negate)throw new Error(w)}}u=ze(n[r.nextIndex])}return r.nextIndex++,l}function xr({kind:e,min:r,max:t},n){const o=n.parent,s=o.body.at(-1);if(!s||!fr(s))throw new Error("Quantifier requires a repeatable token");const a=ft(e,r,t,s);return o.body.pop(),a}function kr({raw:e},r){const{capturingGroups:t,subroutines:n}=r;let o=e.slice(3,-1);const s=/^(?<sign>[-+]?)0*(?<num>[1-9]\d*)$/.exec(o);if(s){const i=+s.groups.num,l=t.length;if(r.hasNumberedRef=!0,o={"":i,"+":l+i,"-":l+1-i}[s.groups.sign],o<1)throw new Error("Invalid subroutine number")}else o==="0"&&(o=0);const a=gt(o);return n.push(a),a}function vr(e,r){return{type:"AbsenceFunction",kind:e,body:te(r?.body)}}function V(e){return{type:"Alternative",body:ht(e?.body)}}function be(e,r){const t={type:"Assertion",kind:e};return(e==="word_boundary"||e==="text_segment_boundary")&&(t.negate=!!r?.negate),t}function Ce(e,r){const t=!!r?.orphan;return{type:"Backreference",ref:e,...t&&{orphan:t}}}function dt(e,r){const t={name:void 0,isSubroutined:!1,...r};if(t.name!==void 0&&!Nr(t.name))throw new Error(`Group name "${t.name}" invalid in Oniguruma`);return{type:"CapturingGroup",number:e,...t.name&&{name:t.name},...t.isSubroutined&&{isSubroutined:t.isSubroutined},body:te(r?.body)}}function ue(e,r){const t={useLastValid:!1,...r};if(e>1114111){const n=e.toString(16);if(t.useLastValid)e=1114111;else throw e>1310719?new Error(`Invalid code point out of range "\\x{${n}}"`):new Error(`Invalid code point out of range in JS "\\x{${n}}"`)}return{type:"Character",value:e}}function ie(e){const r={kind:"union",negate:!1,...e};return{type:"CharacterClass",kind:r.kind,negate:r.negate,body:ht(e?.body)}}function Er(e,r){if(r.value<e.value)throw new Error("Character class range out of order");return{type:"CharacterClassRange",min:e,max:r}}function xe(e,r){const t=!!r?.negate,n={type:"CharacterSet",kind:e};return(e==="digit"||e==="hex"||e==="newline"||e==="space"||e==="word")&&(n.negate=t),(e==="text_segment"||e==="newline"&&!t)&&(n.variableLength=!0),n}function $r(e,r={}){if(e==="keep")return{type:"Directive",kind:e};if(e==="flags")return{type:"Directive",kind:e,flags:J(r.flags)};throw new Error(`Unexpected directive kind "${e}"`)}function Ar(e){return{type:"Flags",...e}}function M(e){const r=e?.atomic,t=e?.flags;if(r&&t)throw new Error("Atomic group cannot have flags");return{type:"Group",...r&&{atomic:r},...t&&{flags:t},body:te(e?.body)}}function O(e){const r={behind:!1,negate:!1,...e};return{type:"LookaroundAssertion",kind:r.behind?"lookbehind":"lookahead",negate:r.negate,body:te(e?.body)}}function _r(e,r,t){return{type:"NamedCallout",kind:e,tag:r,arguments:t}}function Ir(e,r){const t=!!r?.negate;if(!$e.has(e))throw new Error(`Invalid POSIX class "${e}"`);return{type:"CharacterSet",kind:"posix",value:e,negate:t}}function ft(e,r,t,n){if(r>t)throw new Error("Invalid reversed quantifier range");return{type:"Quantifier",kind:e,min:r,max:t,body:n}}function Sr(e,r){return{type:"Regex",body:te(r?.body),flags:e}}function gt(e){return{type:"Subroutine",ref:e}}function q(e,r){const t={negate:!1,normalizeUnknownPropertyNames:!1,skipPropertyNameValidation:!1,unicodePropertyMap:null,...r};let n=t.unicodePropertyMap?.get(ce(e));if(!n){if(t.normalizeUnknownPropertyNames)n=Pr(e);else if(t.unicodePropertyMap&&!t.skipPropertyNameValidation)throw new Error(k`Invalid Unicode property "\p{${e}}"`)}return{type:"CharacterSet",kind:"property",value:n??e,negate:t.negate}}function Mr({flags:e,kind:r,name:t,negate:n,number:o}){switch(r){case"absence_repeater":return vr("repeater");case"atomic":return M({atomic:!0});case"capturing":return dt(o,{name:t});case"group":return M({flags:e});case"lookahead":case"lookbehind":return O({behind:r==="lookbehind",negate:n});default:throw new Error(`Unexpected group kind "${r}"`)}}function te(e){if(e===void 0)e=[V()];else if(!Array.isArray(e)||!e.length||!e.every(r=>r.type==="Alternative"))throw new Error("Invalid body; expected array of one or more Alternative nodes");return e}function ht(e){if(e===void 0)e=[];else if(!Array.isArray(e)||!e.every(r=>!!r.type))throw new Error("Invalid body; expected array of nodes");return e}function Be(e){return e.type==="LookaroundAssertion"&&e.kind==="lookahead"}function Ve(e){return e.type==="LookaroundAssertion"&&e.kind==="lookbehind"}function Nr(e){return/^[\p{Alpha}\p{Pc}][^)]*$/u.test(e)}function Pr(e){return e.trim().replace(/[- _]+/g,"_").replace(/[A-Z][a-z]+(?=[A-Z])/g,"$&_").replace(/[A-Za-z]+/g,r=>r[0].toUpperCase()+r.slice(1).toLowerCase())}function ce(e){return e.replace(/[- _]+/g,"").toLowerCase()}function He(e,r){return J(e,`${r?.type==="Character"&&r.value===93?"Empty":"Unclosed"} character class`)}function ze(e){return J(e,"Unclosed group")}function Y(e,r,t=null){function n(s,a){for(let i=0;i<s.length;i++){const l=o(s[i],a,i,s);i=Math.max(-1,i+l)}}function o(s,a=null,i=null,l=null){let c=0,d=!1;const p={node:s,parent:a,key:i,container:l,root:e,remove(){oe(l).splice(Math.max(0,W(i)+c),1),c--,d=!0},removeAllNextSiblings(){return oe(l).splice(W(i)+1)},removeAllPrevSiblings(){const b=W(i)+c;return c-=b,oe(l).splice(0,Math.max(0,b))},replaceWith(b,E={}){const $=!!E.traverse;l?l[Math.max(0,W(i)+c)]=b:J(a,"Can't replace root node")[i]=b,$&&o(b,a,i,l),d=!0},replaceWithMultiple(b,E={}){const $=!!E.traverse;if(oe(l).splice(Math.max(0,W(i)+c),1,...b),c+=b.length-1,$){let v=0;for(let A=0;A<b.length;A++)v+=o(b[A],a,W(i)+A+v,l)}d=!0},skip(){d=!0}},{type:u}=s,g=r["*"],f=r[u],w=typeof g=="function"?g:g?.enter,y=typeof f=="function"?f:f?.enter;if(w?.(p,t),y?.(p,t),!d)switch(u){case"AbsenceFunction":case"CapturingGroup":case"Group":n(s.body,s);break;case"Alternative":case"CharacterClass":n(s.body,s);break;case"Assertion":case"Backreference":case"Character":case"CharacterSet":case"Directive":case"Flags":case"NamedCallout":case"Subroutine":break;case"CharacterClassRange":o(s.min,s,"min"),o(s.max,s,"max");break;case"LookaroundAssertion":n(s.body,s);break;case"Quantifier":o(s.body,s,"body");break;case"Regex":n(s.body,s),o(s.flags,s,"flags");break;default:throw new Error(`Unexpected node type "${u}"`)}return f?.exit?.(p,t),g?.exit?.(p,t),c}return o(e),e}function oe(e){if(!Array.isArray(e))throw new Error("Container expected");return e}function W(e){if(typeof e!="number")throw new Error("Numeric key expected");return e}const Lr=String.raw`\(\?(?:[:=!>A-Za-z\-]|<[=!]|\(DEFINE\))`;function Fr(e,r){for(let t=0;t<e.length;t++)e[t]>=r&&e[t]++}function Gr(e,r,t,n){return e.slice(0,r)+n+e.slice(r+t.length)}const I=Object.freeze({DEFAULT:"DEFAULT",CHAR_CLASS:"CHAR_CLASS"});function _e(e,r,t,n){const o=new RegExp(String.raw`${r}|(?<$skip>\[\^?|\\?.)`,"gsu"),s=[!1];let a=0,i="";for(const l of e.matchAll(o)){const{0:c,groups:{$skip:d}}=l;if(!d&&(!n||n===I.DEFAULT==!a)){t instanceof Function?i+=t(l,{context:a?I.CHAR_CLASS:I.DEFAULT,negated:s[s.length-1]}):i+=t;continue}c[0]==="["?(a++,s.push(c[1]==="^")):c==="]"&&a&&(a--,s.pop()),i+=c}return i}function mt(e,r,t,n){_e(e,r,t,n)}function Rr(e,r,t=0,n){if(!new RegExp(r,"su").test(e))return null;const o=new RegExp(`${r}|(?<$skip>\\\\?.)`,"gsu");o.lastIndex=t;let s=0,a;for(;a=o.exec(e);){const{0:i,groups:{$skip:l}}=a;if(!l&&(!n||n===I.DEFAULT==!s))return a;i==="["?s++:i==="]"&&s&&s--,o.lastIndex==a.index&&o.lastIndex++}return null}function ae(e,r,t){return!!Rr(e,r,0,t)}function Ur(e,r){const t=/\\?./gsu;t.lastIndex=r;let n=e.length,o=0,s=1,a;for(;a=t.exec(e);){const[i]=a;if(i==="[")o++;else if(o)i==="]"&&o--;else if(i==="(")s++;else if(i===")"&&(s--,!s)){n=a.index;break}}return e.slice(r,n)}const je=new RegExp(String.raw`(?<noncapturingStart>${Lr})|(?<capturingStart>\((?:\?<[^>]+>)?)|\\?.`,"gsu");function Tr(e,r){const t=r?.hiddenCaptures??[];let n=r?.captureTransfers??new Map;if(!/\(\?>/.test(e))return{pattern:e,captureTransfers:n,hiddenCaptures:t};const o="(?>",s="(?:(?=(",a=[0],i=[];let l=0,c=0,d=NaN,p;do{p=!1;let u=0,g=0,f=!1,w;for(je.lastIndex=Number.isNaN(d)?0:d+s.length;w=je.exec(e);){const{0:y,index:b,groups:{capturingStart:E,noncapturingStart:$}}=w;if(y==="[")u++;else if(u)y==="]"&&u--;else if(y===o&&!f)d=b,f=!0;else if(f&&$)g++;else if(E)f?g++:(l++,a.push(l+c));else if(y===")"&&f){if(!g){c++;const v=l+c;if(e=`${e.slice(0,d)}${s}${e.slice(d+o.length,b)}))<$$${v}>)${e.slice(b+1)}`,p=!0,i.push(v),Fr(t,v),n.size){const A=new Map;n.forEach((re,H)=>{A.set(H>=v?H+1:H,re.map(z=>z>=v?z+1:z))}),n=A}break}g--}}}while(p);return t.push(...i),e=_e(e,String.raw`\\(?<backrefNum>[1-9]\d*)|<\$\$(?<wrappedBackrefNum>\d+)>`,({0:u,groups:{backrefNum:g,wrappedBackrefNum:f}})=>{if(g){const w=+g;if(w>a.length-1)throw new Error(`Backref "${u}" greater than number of captures`);return`\\${a[w]}`}return`\\${f}`},I.DEFAULT),{pattern:e,captureTransfers:n,hiddenCaptures:t}}const wt=String.raw`(?:[?*+]|\{\d+(?:,\d*)?\})`,fe=new RegExp(String.raw`
\\(?: \d+
  | c[A-Za-z]
  | [gk]<[^>]+>
  | [pPu]\{[^\}]+\}
  | u[A-Fa-f\d]{4}
  | x[A-Fa-f\d]{2}
  )
| \((?: \? (?: [:=!>]
  | <(?:[=!]|[^>]+>)
  | [A-Za-z\-]+:
  | \(DEFINE\)
  ))?
| (?<qBase>${wt})(?<qMod>[?+]?)(?<invalidQ>[?*+\{]?)
| \\?.
`.replace(/\s+/g,""),"gsu");function Dr(e){if(!new RegExp(`${wt}\\+`).test(e))return{pattern:e};const r=[];let t=null,n=null,o="",s=0,a;for(fe.lastIndex=0;a=fe.exec(e);){const{0:i,index:l,groups:{qBase:c,qMod:d,invalidQ:p}}=a;if(i==="[")s||(n=l),s++;else if(i==="]")s?s--:n=null;else if(!s)if(d==="+"&&o&&!o.startsWith("(")){if(p)throw new Error(`Invalid quantifier "${i}"`);let u=-1;if(/^\{\d+\}$/.test(c))e=Gr(e,l+c.length,d,"");else{if(o===")"||o==="]"){const g=o===")"?t:n;if(g===null)throw new Error(`Invalid unmatched "${o}"`);e=`${e.slice(0,g)}(?>${e.slice(g,l)}${c})${e.slice(l+i.length)}`}else e=`${e.slice(0,l-o.length)}(?>${o}${c})${e.slice(l+i.length)}`;u+=4}fe.lastIndex+=u}else i[0]==="("?r.push(l):i===")"&&(t=r.length?r.pop():null);o=i}return{pattern:e}}const _=String.raw,Or=_`\\g<(?<gRNameOrNum>[^>&]+)&R=(?<gRDepth>[^>]+)>`,ke=_`\(\?R=(?<rDepth>[^\)]+)\)|${Or}`,pe=_`\(\?<(?![=!])(?<captureName>[^>]+)>`,yt=_`${pe}|(?<unnamed>\()(?!\?)`,D=new RegExp(_`${pe}|${ke}|\(\?|\\?.`,"gsu"),ge="Cannot use multiple overlapping recursions";function Br(e,r){const{hiddenCaptures:t,mode:n}={hiddenCaptures:[],mode:"plugin",...r};let o=r?.captureTransfers??new Map;if(!new RegExp(ke,"su").test(e))return{pattern:e,captureTransfers:o,hiddenCaptures:t};if(n==="plugin"&&ae(e,_`\(\?\(DEFINE\)`,I.DEFAULT))throw new Error("DEFINE groups cannot be used with recursion");const s=[],a=ae(e,_`\\[1-9]`,I.DEFAULT),i=new Map,l=[];let c=!1,d=0,p=0,u;for(D.lastIndex=0;u=D.exec(e);){const{0:g,groups:{captureName:f,rDepth:w,gRNameOrNum:y,gRDepth:b}}=u;if(g==="[")d++;else if(d)g==="]"&&d--;else if(w){if(We(w),c)throw new Error(ge);if(a)throw new Error(`${n==="external"?"Backrefs":"Numbered backrefs"} cannot be used with global recursion`);const E=e.slice(0,u.index),$=e.slice(D.lastIndex);if(ae($,ke,I.DEFAULT))throw new Error(ge);const v=+w-1;e=Xe(E,$,v,!1,t,s,p),o=qe(o,E,v,s.length,0,p);break}else if(y){We(b);let E=!1;for(const K of l)if(K.name===y||K.num===+y){if(E=!0,K.hasRecursedWithin)throw new Error(ge);break}if(!E)throw new Error(_`Recursive \g cannot be used outside the referenced group "${n==="external"?y:_`\g<${y}&R=${b}>`}"`);const $=i.get(y),v=Ur(e,$);if(a&&ae(v,_`${pe}|\((?!\?)`,I.DEFAULT))throw new Error(`${n==="external"?"Backrefs":"Numbered backrefs"} cannot be used with recursion of capturing groups`);const A=e.slice($,u.index),re=v.slice(A.length+g.length),H=s.length,z=+b-1,Me=Xe(A,re,z,!0,t,s,p);o=qe(o,A,z,s.length-H,H,p);const Mt=e.slice(0,$),Nt=e.slice($+v.length);e=`${Mt}${Me}${Nt}`,D.lastIndex+=Me.length-g.length-A.length-re.length,l.forEach(K=>K.hasRecursedWithin=!0),c=!0}else if(f)p++,i.set(String(p),D.lastIndex),i.set(f,D.lastIndex),l.push({num:p,name:f});else if(g[0]==="("){const E=g==="(";E&&(p++,i.set(String(p),D.lastIndex)),l.push(E?{num:p}:{})}else g===")"&&l.pop()}return t.push(...s),{pattern:e,captureTransfers:o,hiddenCaptures:t}}function We(e){const r=`Max depth must be integer between 2 and 100; used ${e}`;if(!/^[1-9]\d*$/.test(e))throw new Error(r);if(e=+e,e<2||e>100)throw new Error(r)}function Xe(e,r,t,n,o,s,a){const i=new Set;n&&mt(e+r,pe,({groups:{captureName:c}})=>{i.add(c)},I.DEFAULT);const l=[t,n?i:null,o,s,a];return`${e}${Ze(`(?:${e}`,"forward",...l)}(?:)${Ze(`${r})`,"backward",...l)}${r}`}function Ze(e,r,t,n,o,s,a){const l=d=>r==="forward"?d+2:t-d+2-1;let c="";for(let d=0;d<t;d++){const p=l(d);c+=_e(e,_`${yt}|\\k<(?<backref>[^>]+)>`,({0:u,groups:{captureName:g,unnamed:f,backref:w}})=>{if(w&&n&&!n.has(w))return u;const y=`_$${p}`;if(f||g){const b=a+s.length+1;return s.push(b),Vr(o,b),f?u:`(?<${g}${y}>`}return _`\k<${w}${y}>`},I.DEFAULT)}return c}function Vr(e,r){for(let t=0;t<e.length;t++)e[t]>=r&&e[t]++}function qe(e,r,t,n,o,s){if(e.size&&n){let a=0;mt(r,yt,()=>a++,I.DEFAULT);const i=s-a+o,l=new Map;return e.forEach((c,d)=>{const p=(n-a*t)/t,u=a*t,g=d>i+a?d+n:d,f=[];for(const w of c)if(w<=i)f.push(w);else if(w>i+a+p)f.push(w+n);else if(w<=i+a)for(let y=0;y<=t;y++)f.push(w+a*y);else for(let y=0;y<=t;y++)f.push(w+u+p*y);l.set(g,f)}),l}return e}var x=String.fromCodePoint,h=String.raw,R={flagGroups:(()=>{try{new RegExp("(?i:)")}catch{return!1}return!0})(),unicodeSets:(()=>{try{new RegExp("","v")}catch{return!1}return!0})()};R.bugFlagVLiteralHyphenIsRange=R.unicodeSets?(()=>{try{new RegExp(h`[\d\-a]`,"v")}catch{return!0}return!1})():!1;R.bugNestedClassIgnoresNegation=R.unicodeSets&&new RegExp("[[^a]]","v").test("a");function le(e,{enable:r,disable:t}){return{dotAll:!t?.dotAll&&!!(r?.dotAll||e.dotAll),ignoreCase:!t?.ignoreCase&&!!(r?.ignoreCase||e.ignoreCase)}}function ee(e,r,t){return e.has(r)||e.set(r,t),e.get(r)}function ve(e,r){return Qe[e]>=Qe[r]}function Hr(e,r){if(e==null)throw new Error(r??"Value expected");return e}var Qe={ES2025:2025,ES2024:2024,ES2018:2018},zr={auto:"auto",ES2025:"ES2025",ES2024:"ES2024",ES2018:"ES2018"};function bt(e={}){if({}.toString.call(e)!=="[object Object]")throw new Error("Unexpected options");if(e.target!==void 0&&!zr[e.target])throw new Error(`Unexpected target "${e.target}"`);const r={accuracy:"default",avoidSubclass:!1,flags:"",global:!1,hasIndices:!1,lazyCompileLength:1/0,target:"auto",verbose:!1,...e,rules:{allowOrphanBackrefs:!1,asciiWordBoundaries:!1,captureGroup:!1,recursionLimit:20,singleline:!1,...e.rules}};return r.target==="auto"&&(r.target=R.flagGroups?"ES2025":R.unicodeSets?"ES2024":"ES2018"),r}var jr="[	-\r ]",Wr=new Set([x(304),x(305)]),L=h`[\p{L}\p{M}\p{N}\p{Pc}]`;function Ct(e){if(Wr.has(e))return[e];const r=new Set,t=e.toLowerCase(),n=t.toUpperCase(),o=qr.get(t),s=Xr.get(t),a=Zr.get(t);return[...n].length===1&&r.add(n),a&&r.add(a),o&&r.add(o),r.add(t),s&&r.add(s),[...r]}var Ie=new Map(`C Other
Cc Control cntrl
Cf Format
Cn Unassigned
Co Private_Use
Cs Surrogate
L Letter
LC Cased_Letter
Ll Lowercase_Letter
Lm Modifier_Letter
Lo Other_Letter
Lt Titlecase_Letter
Lu Uppercase_Letter
M Mark Combining_Mark
Mc Spacing_Mark
Me Enclosing_Mark
Mn Nonspacing_Mark
N Number
Nd Decimal_Number digit
Nl Letter_Number
No Other_Number
P Punctuation punct
Pc Connector_Punctuation
Pd Dash_Punctuation
Pe Close_Punctuation
Pf Final_Punctuation
Pi Initial_Punctuation
Po Other_Punctuation
Ps Open_Punctuation
S Symbol
Sc Currency_Symbol
Sk Modifier_Symbol
Sm Math_Symbol
So Other_Symbol
Z Separator
Zl Line_Separator
Zp Paragraph_Separator
Zs Space_Separator
ASCII
ASCII_Hex_Digit AHex
Alphabetic Alpha
Any
Assigned
Bidi_Control Bidi_C
Bidi_Mirrored Bidi_M
Case_Ignorable CI
Cased
Changes_When_Casefolded CWCF
Changes_When_Casemapped CWCM
Changes_When_Lowercased CWL
Changes_When_NFKC_Casefolded CWKCF
Changes_When_Titlecased CWT
Changes_When_Uppercased CWU
Dash
Default_Ignorable_Code_Point DI
Deprecated Dep
Diacritic Dia
Emoji
Emoji_Component EComp
Emoji_Modifier EMod
Emoji_Modifier_Base EBase
Emoji_Presentation EPres
Extended_Pictographic ExtPict
Extender Ext
Grapheme_Base Gr_Base
Grapheme_Extend Gr_Ext
Hex_Digit Hex
IDS_Binary_Operator IDSB
IDS_Trinary_Operator IDST
ID_Continue IDC
ID_Start IDS
Ideographic Ideo
Join_Control Join_C
Logical_Order_Exception LOE
Lowercase Lower
Math
Noncharacter_Code_Point NChar
Pattern_Syntax Pat_Syn
Pattern_White_Space Pat_WS
Quotation_Mark QMark
Radical
Regional_Indicator RI
Sentence_Terminal STerm
Soft_Dotted SD
Terminal_Punctuation Term
Unified_Ideograph UIdeo
Uppercase Upper
Variation_Selector VS
White_Space space
XID_Continue XIDC
XID_Start XIDS`.split(/\s/).map(e=>[ce(e),e])),Xr=new Map([["s",x(383)],[x(383),"s"]]),Zr=new Map([[x(223),x(7838)],[x(107),x(8490)],[x(229),x(8491)],[x(969),x(8486)]]),qr=new Map([U(453),U(456),U(459),U(498),...he(8072,8079),...he(8088,8095),...he(8104,8111),U(8124),U(8140),U(8188)]),Qr=new Map([["alnum",h`[\p{Alpha}\p{Nd}]`],["alpha",h`\p{Alpha}`],["ascii",h`\p{ASCII}`],["blank",h`[\p{Zs}\t]`],["cntrl",h`\p{Cc}`],["digit",h`\p{Nd}`],["graph",h`[\P{space}&&\P{Cc}&&\P{Cn}&&\P{Cs}]`],["lower",h`\p{Lower}`],["print",h`[[\P{space}&&\P{Cc}&&\P{Cn}&&\P{Cs}]\p{Zs}]`],["punct",h`[\p{P}\p{S}]`],["space",h`\p{space}`],["upper",h`\p{Upper}`],["word",h`[\p{Alpha}\p{M}\p{Nd}\p{Pc}]`],["xdigit",h`\p{AHex}`]]);function Jr(e,r){const t=[];for(let n=e;n<=r;n++)t.push(n);return t}function U(e){const r=x(e);return[r.toLowerCase(),r]}function he(e,r){return Jr(e,r).map(t=>U(t))}var xt=new Set(["Lower","Lowercase","Upper","Uppercase","Ll","Lowercase_Letter","Lt","Titlecase_Letter","Lu","Uppercase_Letter"]);function Kr(e,r){const t={accuracy:"default",asciiWordBoundaries:!1,avoidSubclass:!1,bestEffortTarget:"ES2025",...r};kt(e);const n={accuracy:t.accuracy,asciiWordBoundaries:t.asciiWordBoundaries,avoidSubclass:t.avoidSubclass,flagDirectivesByAlt:new Map,jsGroupNameMap:new Map,minTargetEs2024:ve(t.bestEffortTarget,"ES2024"),passedLookbehind:!1,strategy:null,subroutineRefMap:new Map,supportedGNodes:new Set,digitIsAscii:e.flags.digitIsAscii,spaceIsAscii:e.flags.spaceIsAscii,wordIsAscii:e.flags.wordIsAscii};Y(e,Yr,n);const o={dotAll:e.flags.dotAll,ignoreCase:e.flags.ignoreCase},s={currentFlags:o,prevFlags:null,globalFlags:o,groupOriginByCopy:new Map,groupsByName:new Map,multiplexCapturesToLeftByRef:new Map,openRefs:new Map,reffedNodesByReferencer:new Map,subroutineRefMap:n.subroutineRefMap};Y(e,en,s);const a={groupsByName:s.groupsByName,highestOrphanBackref:0,numCapturesToLeft:0,reffedNodesByReferencer:s.reffedNodesByReferencer};return Y(e,tn,a),e._originMap=s.groupOriginByCopy,e._strategy=n.strategy,e}var Yr={AbsenceFunction({node:e,parent:r,replaceWith:t}){const{body:n,kind:o}=e;if(o==="repeater"){const s=M();s.body[0].body.push(O({negate:!0,body:n}),q("Any"));const a=M();a.body[0].body.push(ft("greedy",0,1/0,s)),t(C(a,r),{traverse:!0})}else throw new Error('Unsupported absence function "(?~|"')},Alternative:{enter({node:e,parent:r,key:t},{flagDirectivesByAlt:n}){const o=e.body.filter(s=>s.kind==="flags");for(let s=t+1;s<r.body.length;s++){const a=r.body[s];ee(n,a,[]).push(...o)}},exit({node:e},{flagDirectivesByAlt:r}){if(r.get(e)?.length){const t=Et(r.get(e));if(t){const n=M({flags:t});n.body[0].body=e.body,e.body=[C(n,e)]}}}},Assertion({node:e,parent:r,key:t,container:n,root:o,remove:s,replaceWith:a},i){const{kind:l,negate:c}=e,{asciiWordBoundaries:d,avoidSubclass:p,supportedGNodes:u,wordIsAscii:g}=i;if(l==="text_segment_boundary")throw new Error(`Unsupported text segment boundary "\\${c?"Y":"y"}"`);if(l==="line_end")a(C(O({body:[V({body:[be("string_end")]}),V({body:[ue(10)]})]}),r));else if(l==="line_start")a(C(F(h`(?<=\A|\n(?!\z))`,{skipLookbehindValidation:!0}),r));else if(l==="search_start")if(u.has(e))o.flags.sticky=!0,s();else{const f=n[t-1];if(f&&ln(f))a(C(O({negate:!0}),r));else{if(p)throw new Error(h`Uses "\G" in a way that requires a subclass`);a(T(be("string_start"),r)),i.strategy="clip_search"}}else if(!(l==="string_end"||l==="string_start"))if(l==="string_end_newline")a(C(F(h`(?=\n?\z)`),r));else if(l==="word_boundary"){if(!g&&!d){const f=`(?:(?<=${L})(?!${L})|(?<!${L})(?=${L}))`,w=`(?:(?<=${L})(?=${L})|(?<!${L})(?!${L}))`;a(C(F(c?w:f),r))}}else throw new Error(`Unexpected assertion kind "${l}"`)},Backreference({node:e},{jsGroupNameMap:r}){let{ref:t}=e;typeof t=="string"&&!we(t)&&(t=me(t,r),e.ref=t)},CapturingGroup({node:e},{jsGroupNameMap:r,subroutineRefMap:t}){let{name:n}=e;n&&!we(n)&&(n=me(n,r),e.name=n),t.set(e.number,e),n&&t.set(n,e)},CharacterClassRange({node:e,parent:r,replaceWith:t}){if(r.kind==="intersection"){const n=ie({body:[e]});t(C(n,r),{traverse:!0})}},CharacterSet({node:e,parent:r,replaceWith:t},{accuracy:n,minTargetEs2024:o,digitIsAscii:s,spaceIsAscii:a,wordIsAscii:i}){const{kind:l,negate:c,value:d}=e;if(s&&(l==="digit"||d==="digit")){t(T(xe("digit",{negate:c}),r));return}if(a&&(l==="space"||d==="space")){t(C(ye(F(jr),c),r));return}if(i&&(l==="word"||d==="word")){t(T(xe("word",{negate:c}),r));return}if(l==="any")t(T(q("Any"),r));else if(l==="digit")t(T(q("Nd",{negate:c}),r));else if(l!=="dot")if(l==="text_segment"){if(n==="strict")throw new Error(h`Use of "\X" requires non-strict accuracy`);const p="\\p{Emoji}(?:\\p{EMod}|\\uFE0F\\u20E3?|[\\x{E0020}-\\x{E007E}]+\\x{E007F})?",u=h`\p{RI}{2}|${p}(?:\u200D${p})*`;t(C(F(h`(?>\r\n|${o?h`\p{RGI_Emoji}`:u}|\P{M}\p{M}*)`,{skipPropertyNameValidation:!0}),r))}else if(l==="hex")t(T(q("AHex",{negate:c}),r));else if(l==="newline")t(C(F(c?`[^
]`:`(?>\r
?|[
\v\f\u2028\u2029])`),r));else if(l==="posix")if(!o&&(d==="graph"||d==="print")){if(n==="strict")throw new Error(`POSIX class "${d}" requires min target ES2024 or non-strict accuracy`);let p={graph:"!-~",print:" -~"}[d];c&&(p=`\0-${x(p.codePointAt(0)-1)}${x(p.codePointAt(2)+1)}-􏿿`),t(C(F(`[${p}]`),r))}else t(C(ye(F(Qr.get(d)),c),r));else if(l==="property")Ie.has(ce(d))||(e.key="sc");else if(l==="space")t(T(q("space",{negate:c}),r));else if(l==="word")t(C(ye(F(L),c),r));else throw new Error(`Unexpected character set kind "${l}"`)},Directive({node:e,parent:r,root:t,remove:n,replaceWith:o,removeAllPrevSiblings:s,removeAllNextSiblings:a}){const{kind:i,flags:l}=e;if(i==="flags")if(!l.enable&&!l.disable)n();else{const c=M({flags:l});c.body[0].body=a(),o(C(c,r),{traverse:!0})}else if(i==="keep"){const c=t.body[0],p=t.body.length===1&&ct(c,{type:"Group"})&&c.body[0].body.length===1?c.body[0]:t;if(r.parent!==p||p.body.length>1)throw new Error(h`Uses "\K" in a way that's unsupported`);const u=O({behind:!0});u.body[0].body=s(),o(C(u,r))}else throw new Error(`Unexpected directive kind "${i}"`)},Flags({node:e,parent:r}){if(e.posixIsAscii)throw new Error('Unsupported flag "P"');if(e.textSegmentMode==="word")throw new Error('Unsupported flag "y{w}"');["digitIsAscii","extended","posixIsAscii","spaceIsAscii","wordIsAscii","textSegmentMode"].forEach(t=>delete e[t]),Object.assign(e,{global:!1,hasIndices:!1,multiline:!1,sticky:e.sticky??!1}),r.options={disable:{x:!0,n:!0},force:{v:!0}}},Group({node:e}){if(!e.flags)return;const{enable:r,disable:t}=e.flags;r?.extended&&delete r.extended,t?.extended&&delete t.extended,r?.dotAll&&t?.dotAll&&delete r.dotAll,r?.ignoreCase&&t?.ignoreCase&&delete r.ignoreCase,r&&!Object.keys(r).length&&delete e.flags.enable,t&&!Object.keys(t).length&&delete e.flags.disable,!e.flags.enable&&!e.flags.disable&&delete e.flags},LookaroundAssertion({node:e},r){const{kind:t}=e;t==="lookbehind"&&(r.passedLookbehind=!0)},NamedCallout({node:e,parent:r,replaceWith:t}){const{kind:n}=e;if(n==="fail")t(C(O({negate:!0}),r));else throw new Error(`Unsupported named callout "(*${n.toUpperCase()}"`)},Quantifier({node:e}){if(e.body.type==="Quantifier"){const r=M();r.body[0].body.push(e.body),e.body=C(r,e)}},Regex:{enter({node:e},{supportedGNodes:r}){const t=[];let n=!1,o=!1;for(const s of e.body)if(s.body.length===1&&s.body[0].kind==="search_start")s.body.pop();else{const a=At(s.body);a?(n=!0,Array.isArray(a)?t.push(...a):t.push(a)):o=!0}n&&!o&&t.forEach(s=>r.add(s))},exit(e,{accuracy:r,passedLookbehind:t,strategy:n}){if(r==="strict"&&t&&n)throw new Error(h`Uses "\G" in a way that requires non-strict accuracy`)}},Subroutine({node:e},{jsGroupNameMap:r}){let{ref:t}=e;typeof t=="string"&&!we(t)&&(t=me(t,r),e.ref=t)}},en={Backreference({node:e},{multiplexCapturesToLeftByRef:r,reffedNodesByReferencer:t}){const{orphan:n,ref:o}=e;n||t.set(e,[...r.get(o).map(({node:s})=>s)])},CapturingGroup:{enter({node:e,parent:r,replaceWith:t,skip:n},{groupOriginByCopy:o,groupsByName:s,multiplexCapturesToLeftByRef:a,openRefs:i,reffedNodesByReferencer:l}){const c=o.get(e);if(c&&i.has(e.number)){const p=T(Je(e.number),r);l.set(p,i.get(e.number)),t(p);return}i.set(e.number,e),a.set(e.number,[]),e.name&&ee(a,e.name,[]);const d=a.get(e.name??e.number);for(let p=0;p<d.length;p++){const u=d[p];if(c===u.node||c&&c===u.origin||e===u.origin){d.splice(p,1);break}}if(a.get(e.number).push({node:e,origin:c}),e.name&&a.get(e.name).push({node:e,origin:c}),e.name){const p=ee(s,e.name,new Map);let u=!1;if(c)u=!0;else for(const g of p.values())if(!g.hasDuplicateNameToRemove){u=!0;break}s.get(e.name).set(e,{node:e,hasDuplicateNameToRemove:u})}},exit({node:e},{openRefs:r}){r.delete(e.number)}},Group:{enter({node:e},r){r.prevFlags=r.currentFlags,e.flags&&(r.currentFlags=le(r.currentFlags,e.flags))},exit(e,r){r.currentFlags=r.prevFlags}},Subroutine({node:e,parent:r,replaceWith:t},n){const{isRecursive:o,ref:s}=e;if(o){let d=r;for(;(d=d.parent)&&!(d.type==="CapturingGroup"&&(d.name===s||d.number===s)););n.reffedNodesByReferencer.set(e,d);return}const a=n.subroutineRefMap.get(s),i=s===0,l=i?Je(0):vt(a,n.groupOriginByCopy,null);let c=l;if(!i){const d=Et(sn(a,u=>u.type==="Group"&&!!u.flags)),p=d?le(n.globalFlags,d):n.globalFlags;rn(p,n.currentFlags)||(c=M({flags:on(p)}),c.body[0].body.push(l))}t(C(c,r),{traverse:!i})}},tn={Backreference({node:e,parent:r,replaceWith:t},n){if(e.orphan){n.highestOrphanBackref=Math.max(n.highestOrphanBackref,e.ref);return}const s=n.reffedNodesByReferencer.get(e).filter(a=>nn(a,e));if(!s.length)t(C(O({negate:!0}),r));else if(s.length>1){const a=M({atomic:!0,body:s.reverse().map(i=>V({body:[Ce(i.number)]}))});t(C(a,r))}else e.ref=s[0].number},CapturingGroup({node:e},r){e.number=++r.numCapturesToLeft,e.name&&r.groupsByName.get(e.name).get(e).hasDuplicateNameToRemove&&delete e.name},Regex:{exit({node:e},r){const t=Math.max(r.highestOrphanBackref-r.numCapturesToLeft,0);for(let n=0;n<t;n++){const o=dt();e.body.at(-1).body.push(o)}}},Subroutine({node:e},r){!e.isRecursive||e.ref===0||(e.ref=r.reffedNodesByReferencer.get(e).number)}};function kt(e){Y(e,{"*"({node:r,parent:t}){r.parent=t}})}function rn(e,r){return e.dotAll===r.dotAll&&e.ignoreCase===r.ignoreCase}function nn(e,r){let t=r;do{if(t.type==="Regex")return!1;if(t.type==="Alternative")continue;if(t===e)return!1;const n=$t(t.parent);for(const o of n){if(o===t)break;if(o===e||_t(o,e))return!0}}while(t=t.parent);throw new Error("Unexpected path")}function vt(e,r,t,n){const o=Array.isArray(e)?[]:{};for(const[s,a]of Object.entries(e))s==="parent"?o.parent=Array.isArray(t)?n:t:a&&typeof a=="object"?o[s]=vt(a,r,o,t):(s==="type"&&a==="CapturingGroup"&&r.set(o,r.get(e)??e),o[s]=a);return o}function Je(e){const r=gt(e);return r.isRecursive=!0,r}function sn(e,r){const t=[];for(;e=e.parent;)(!r||r(e))&&t.push(e);return t}function me(e,r){if(r.has(e))return r.get(e);const t=`$${r.size}_${e.replace(/^[^$_\p{IDS}]|[^$\u200C\u200D\p{IDC}]/ug,"_")}`;return r.set(e,t),t}function Et(e){const r=["dotAll","ignoreCase"],t={enable:{},disable:{}};return e.forEach(({flags:n})=>{r.forEach(o=>{n.enable?.[o]&&(delete t.disable[o],t.enable[o]=!0),n.disable?.[o]&&(t.disable[o]=!0)})}),Object.keys(t.enable).length||delete t.enable,Object.keys(t.disable).length||delete t.disable,t.enable||t.disable?t:null}function on({dotAll:e,ignoreCase:r}){const t={};return(e||r)&&(t.enable={},e&&(t.enable.dotAll=!0),r&&(t.enable.ignoreCase=!0)),(!e||!r)&&(t.disable={},!e&&(t.disable.dotAll=!0),!r&&(t.disable.ignoreCase=!0)),t}function $t(e){if(!e)throw new Error("Node expected");const{body:r}=e;return Array.isArray(r)?r:r?[r]:null}function At(e){const r=e.find(t=>t.kind==="search_start"||un(t,{negate:!1})||!an(t));if(!r)return null;if(r.kind==="search_start")return r;if(r.type==="LookaroundAssertion")return r.body[0].body[0];if(r.type==="CapturingGroup"||r.type==="Group"){const t=[];for(const n of r.body){const o=At(n.body);if(!o)return null;Array.isArray(o)?t.push(...o):t.push(o)}return t}return null}function _t(e,r){const t=$t(e)??[];for(const n of t)if(n===r||_t(n,r))return!0;return!1}function an({type:e}){return e==="Assertion"||e==="Directive"||e==="LookaroundAssertion"}function ln(e){const r=["Character","CharacterClass","CharacterSet"];return r.includes(e.type)||e.type==="Quantifier"&&e.min&&r.includes(e.body.type)}function un(e,r){const t={negate:null,...r};return e.type==="LookaroundAssertion"&&(t.negate===null||e.negate===t.negate)&&e.body.length===1&&ct(e.body[0],{type:"Assertion",kind:"search_start"})}function we(e){return/^[$_\p{IDS}][$\u200C\u200D\p{IDC}]*$/u.test(e)}function F(e,r){const n=pt(e,{...r,unicodePropertyMap:Ie}).body;return n.length>1||n[0].body.length>1?M({body:n}):n[0].body[0]}function ye(e,r){return e.negate=r,e}function T(e,r){return e.parent=r,e}function C(e,r){return kt(e),e.parent=r,e}function cn(e,r){const t=bt(r),n=ve(t.target,"ES2024"),o=ve(t.target,"ES2025"),s=t.rules.recursionLimit;if(!Number.isInteger(s)||s<2||s>20)throw new Error("Invalid recursionLimit; use 2-20");let a=null,i=null;if(!o){const g=[e.flags.ignoreCase];Y(e,pn,{getCurrentModI:()=>g.at(-1),popModI(){g.pop()},pushModI(f){g.push(f)},setHasCasedChar(){g.at(-1)?a=!0:i=!0}})}const l={dotAll:e.flags.dotAll,ignoreCase:!!((e.flags.ignoreCase||a)&&!i)};let c=e;const d={accuracy:t.accuracy,appliedGlobalFlags:l,captureMap:new Map,currentFlags:{dotAll:e.flags.dotAll,ignoreCase:e.flags.ignoreCase},inCharClass:!1,lastNode:c,originMap:e._originMap,recursionLimit:s,useAppliedIgnoreCase:!!(!o&&a&&i),useFlagMods:o,useFlagV:n,verbose:t.verbose};function p(g){return d.lastNode=c,c=g,Hr(dn[g.type],`Unexpected node type "${g.type}"`)(g,d,p)}const u={pattern:e.body.map(p).join("|"),flags:p(e.flags),options:{...e.options}};return n||(delete u.options.force.v,u.options.disable.v=!0,u.options.unicodeSetsPlugin=null),u._captureTransfers=new Map,u._hiddenCaptures=[],d.captureMap.forEach((g,f)=>{g.hidden&&u._hiddenCaptures.push(f),g.transferTo&&ee(u._captureTransfers,g.transferTo,[]).push(f)}),u}var pn={"*":{enter({node:e},r){if(Ye(e)){const t=r.getCurrentModI();r.pushModI(e.flags?le({ignoreCase:t},e.flags).ignoreCase:t)}},exit({node:e},r){Ye(e)&&r.popModI()}},Backreference(e,r){r.setHasCasedChar()},Character({node:e},r){Se(x(e.value))&&r.setHasCasedChar()},CharacterClassRange({node:e,skip:r},t){r(),It(e,{firstOnly:!0}).length&&t.setHasCasedChar()},CharacterSet({node:e},r){e.kind==="property"&&xt.has(e.value)&&r.setHasCasedChar()}},dn={Alternative({body:e},r,t){return e.map(t).join("")},Assertion({kind:e,negate:r}){if(e==="string_end")return"$";if(e==="string_start")return"^";if(e==="word_boundary")return r?h`\B`:h`\b`;throw new Error(`Unexpected assertion kind "${e}"`)},Backreference({ref:e},r){if(typeof e!="number")throw new Error("Unexpected named backref in transformed AST");if(!r.useFlagMods&&r.accuracy==="strict"&&r.currentFlags.ignoreCase&&!r.captureMap.get(e).ignoreCase)throw new Error("Use of case-insensitive backref to case-sensitive group requires target ES2025 or non-strict accuracy");return"\\"+e},CapturingGroup(e,r,t){const{body:n,name:o,number:s}=e,a={ignoreCase:r.currentFlags.ignoreCase},i=r.originMap.get(e);return i&&(a.hidden=!0,s>i.number&&(a.transferTo=i.number)),r.captureMap.set(s,a),`(${o?`?<${o}>`:""}${n.map(t).join("|")})`},Character({value:e},r){const t=x(e),n=X(e,{escDigit:r.lastNode.type==="Backreference",inCharClass:r.inCharClass,useFlagV:r.useFlagV});if(n!==t)return n;if(r.useAppliedIgnoreCase&&r.currentFlags.ignoreCase&&Se(t)){const o=Ct(t);return r.inCharClass?o.join(""):o.length>1?`[${o.join("")}]`:o[0]}return t},CharacterClass(e,r,t){const{kind:n,negate:o,parent:s}=e;let{body:a}=e;if(n==="intersection"&&!r.useFlagV)throw new Error("Use of class intersection requires min target ES2024");R.bugFlagVLiteralHyphenIsRange&&r.useFlagV&&a.some(et)&&(a=[ue(45),...a.filter(c=>!et(c))]);const i=()=>`[${o?"^":""}${a.map(t).join(n==="intersection"?"&&":"")}]`;if(!r.inCharClass){if((!r.useFlagV||R.bugNestedClassIgnoresNegation)&&!o){const d=a.filter(p=>p.type==="CharacterClass"&&p.kind==="union"&&p.negate);if(d.length){const p=M(),u=p.body[0];return p.parent=s,u.parent=p,a=a.filter(g=>!d.includes(g)),e.body=a,a.length?(e.parent=u,u.body.push(e)):p.body.pop(),d.forEach(g=>{const f=V({body:[g]});g.parent=f,f.parent=p,p.body.push(f)}),t(p)}}r.inCharClass=!0;const c=i();return r.inCharClass=!1,c}const l=a[0];if(n==="union"&&!o&&l&&((!r.useFlagV||!r.verbose)&&s.kind==="union"&&!(R.bugFlagVLiteralHyphenIsRange&&r.useFlagV)||!r.verbose&&s.kind==="intersection"&&a.length===1&&l.type!=="CharacterClassRange"))return a.map(t).join("");if(!r.useFlagV&&s.type==="CharacterClass")throw new Error("Use of nested character class requires min target ES2024");return i()},CharacterClassRange(e,r){const t=e.min.value,n=e.max.value,o={escDigit:!1,inCharClass:!0,useFlagV:r.useFlagV},s=X(t,o),a=X(n,o),i=new Set;if(r.useAppliedIgnoreCase&&r.currentFlags.ignoreCase){const l=It(e);wn(l).forEach(d=>{i.add(Array.isArray(d)?`${X(d[0],o)}-${X(d[1],o)}`:X(d,o))})}return`${s}-${a}${[...i].join("")}`},CharacterSet({kind:e,negate:r,value:t,key:n},o){if(e==="dot")return o.currentFlags.dotAll?o.appliedGlobalFlags.dotAll||o.useFlagMods?".":"[^]":h`[^\n]`;if(e==="digit")return r?h`\D`:h`\d`;if(e==="property"){if(o.useAppliedIgnoreCase&&o.currentFlags.ignoreCase&&xt.has(t))throw new Error(`Unicode property "${t}" can't be case-insensitive when other chars have specific case`);return`${r?h`\P`:h`\p`}{${n?`${n}=`:""}${t}}`}if(e==="word")return r?h`\W`:h`\w`;throw new Error(`Unexpected character set kind "${e}"`)},Flags(e,r){return(r.appliedGlobalFlags.ignoreCase?"i":"")+(e.dotAll?"s":"")+(e.sticky?"y":"")},Group({atomic:e,body:r,flags:t,parent:n},o,s){const a=o.currentFlags;t&&(o.currentFlags=le(a,t));const i=r.map(s).join("|"),l=!o.verbose&&r.length===1&&n.type!=="Quantifier"&&!e&&(!o.useFlagMods||!t)?i:`(?${yn(e,t,o.useFlagMods)}${i})`;return o.currentFlags=a,l},LookaroundAssertion({body:e,kind:r,negate:t},n,o){return`(?${`${r==="lookahead"?"":"<"}${t?"!":"="}`}${e.map(o).join("|")})`},Quantifier(e,r,t){return t(e.body)+bn(e)},Subroutine({isRecursive:e,ref:r},t){if(!e)throw new Error("Unexpected non-recursive subroutine in transformed AST");const n=t.recursionLimit;return r===0?`(?R=${n})`:h`\g<${r}&R=${n}>`}},fn=new Set(["$","(",")","*","+",".","?","[","\\","]","^","{","|","}"]),gn=new Set(["-","\\","]","^","["]),hn=new Set(["(",")","-","/","[","\\","]","^","{","|","}","!","#","$","%","&","*","+",",",".",":",";","<","=",">","?","@","`","~"]),Ke=new Map([[9,h`\t`],[10,h`\n`],[11,h`\v`],[12,h`\f`],[13,h`\r`],[8232,h`\u2028`],[8233,h`\u2029`],[65279,h`\uFEFF`]]),mn=new RegExp("^\\p{Cased}$","u");function Se(e){return mn.test(e)}function It(e,r){const t=!!r?.firstOnly,n=e.min.value,o=e.max.value,s=[];if(n<65&&(o===65535||o>=131071)||n===65536&&o>=131071)return s;for(let a=n;a<=o;a++){const i=x(a);if(!Se(i))continue;const l=Ct(i).filter(c=>{const d=c.codePointAt(0);return d<n||d>o});if(l.length&&(s.push(...l),t))break}return s}function X(e,{escDigit:r,inCharClass:t,useFlagV:n}){if(Ke.has(e))return Ke.get(e);if(e<32||e>126&&e<160||e>262143||r&&Cn(e))return e>255?`\\u{${e.toString(16).toUpperCase()}}`:`\\x${e.toString(16).toUpperCase().padStart(2,"0")}`;const o=t?n?hn:gn:fn,s=x(e);return(o.has(s)?"\\":"")+s}function wn(e){const r=e.map(o=>o.codePointAt(0)).sort((o,s)=>o-s),t=[];let n=null;for(let o=0;o<r.length;o++)r[o+1]===r[o]+1?n??=r[o]:n===null?t.push(r[o]):(t.push([n,r[o]]),n=null);return t}function yn(e,r,t){if(e)return">";let n="";if(r&&t){const{enable:o,disable:s}=r;n=(o?.ignoreCase?"i":"")+(o?.dotAll?"s":"")+(s?"-":"")+(s?.ignoreCase?"i":"")+(s?.dotAll?"s":"")}return`${n}:`}function bn({kind:e,max:r,min:t}){let n;return!t&&r===1?n="?":!t&&r===1/0?n="*":t===1&&r===1/0?n="+":t===r?n=`{${t}}`:n=`{${t},${r===1/0?"":r}}`,n+{greedy:"",lazy:"?",possessive:"+"}[e]}function Ye({type:e}){return e==="CapturingGroup"||e==="Group"||e==="LookaroundAssertion"}function Cn(e){return e>47&&e<58}function et({type:e,value:r}){return e==="Character"&&r===45}var xn=class Ee extends RegExp{#t=new Map;#e=null;#n;#r=null;#s=null;rawOptions={};get source(){return this.#n||"(?:)"}constructor(r,t,n){const o=!!n?.lazyCompile;if(r instanceof RegExp){if(n)throw new Error("Cannot provide options when copying a regexp");const s=r;super(s,t),this.#n=s.source,s instanceof Ee&&(this.#t=s.#t,this.#r=s.#r,this.#s=s.#s,this.rawOptions=s.rawOptions)}else{const s={hiddenCaptures:[],strategy:null,transfers:[],...n};super(o?"":r,t),this.#n=r,this.#t=vn(s.hiddenCaptures,s.transfers),this.#s=s.strategy,this.rawOptions=n??{}}o||(this.#e=this)}exec(r){if(!this.#e){const{lazyCompile:o,...s}=this.rawOptions;this.#e=new Ee(this.#n,this.flags,s)}const t=this.global||this.sticky,n=this.lastIndex;if(this.#s==="clip_search"&&t&&n){this.lastIndex=0;const o=this.#o(r.slice(n));return o&&(kn(o,n,r,this.hasIndices),this.lastIndex+=n),o}return this.#o(r)}#o(r){this.#e.lastIndex=this.lastIndex;const t=super.exec.call(this.#e,r);if(this.lastIndex=this.#e.lastIndex,!t||!this.#t.size)return t;const n=[...t];t.length=1;let o;this.hasIndices&&(o=[...t.indices],t.indices.length=1);const s=[0];for(let a=1;a<n.length;a++){const{hidden:i,transferTo:l}=this.#t.get(a)??{};if(i?s.push(null):(s.push(t.length),t.push(n[a]),this.hasIndices&&t.indices.push(o[a])),l&&n[a]!==void 0){const c=s[l];if(!c)throw new Error(`Invalid capture transfer to "${c}"`);if(t[c]=n[a],this.hasIndices&&(t.indices[c]=o[a]),t.groups){this.#r||(this.#r=En(this.source));const d=this.#r.get(l);d&&(t.groups[d]=n[a],this.hasIndices&&(t.indices.groups[d]=o[a]))}}}return t}};function kn(e,r,t,n){if(e.index+=r,e.input=t,n){const o=e.indices;for(let a=0;a<o.length;a++){const i=o[a];i&&(o[a]=[i[0]+r,i[1]+r])}const s=o.groups;s&&Object.keys(s).forEach(a=>{const i=s[a];i&&(s[a]=[i[0]+r,i[1]+r])})}}function vn(e,r){const t=new Map;for(const n of e)t.set(n,{hidden:!0});for(const[n,o]of r)for(const s of o)ee(t,s,{}).transferTo=n;return t}function En(e){const r=/(?<capture>\((?:\?<(?![=!])(?<name>[^>]+)>|(?!\?)))|\\?./gsu,t=new Map;let n=0,o=0,s;for(;s=r.exec(e);){const{0:a,groups:{capture:i,name:l}}=s;a==="["?n++:n?a==="]"&&n--:i&&(o++,l&&t.set(o,l))}return t}function $n(e,r){const t=An(e,r);return t.options?new xn(t.pattern,t.flags,t.options):new RegExp(t.pattern,t.flags)}function An(e,r){const t=bt(r),n=pt(e,{flags:t.flags,normalizeUnknownPropertyNames:!0,rules:{captureGroup:t.rules.captureGroup,singleline:t.rules.singleline},skipBackrefValidation:t.rules.allowOrphanBackrefs,unicodePropertyMap:Ie}),o=Kr(n,{accuracy:t.accuracy,asciiWordBoundaries:t.rules.asciiWordBoundaries,avoidSubclass:t.avoidSubclass,bestEffortTarget:t.target}),s=cn(o,t),a=Br(s.pattern,{captureTransfers:s._captureTransfers,hiddenCaptures:s._hiddenCaptures,mode:"external"}),i=Dr(a.pattern),l=Tr(i.pattern,{captureTransfers:a.captureTransfers,hiddenCaptures:a.hiddenCaptures}),c={pattern:l.pattern,flags:`${t.hasIndices?"d":""}${t.global?"g":""}${s.flags}${s.options.disable.v?"u":"v"}`};if(t.avoidSubclass){if(t.lazyCompileLength!==1/0)throw new Error("Lazy compilation requires subclass")}else{const d=l.hiddenCaptures.sort((f,w)=>f-w),p=Array.from(l.captureTransfers),u=o._strategy,g=c.pattern.length>=t.lazyCompileLength;(d.length||p.length||u||g)&&(c.options={...d.length&&{hiddenCaptures:d},...p.length&&{transfers:p},...u&&{strategy:u},...g&&{lazyCompile:g}})}return c}const tt=4294967295;class _n{constructor(r,t={}){this.patterns=r,this.options=t;const{forgiving:n=!1,cache:o,regexConstructor:s}=t;if(!s)throw new Error("Option `regexConstructor` is not provided");this.regexps=r.map(a=>{if(typeof a!="string")return a;const i=o?.get(a);if(i){if(i instanceof RegExp)return i;if(n)return null;throw i}try{const l=s(a);return o?.set(a,l),l}catch(l){if(o?.set(a,l),n)return null;throw l}})}regexps;findNextMatchSync(r,t,n){const o=typeof r=="string"?r:r.content,s=[];function a(i,l,c=0){return{index:i,captureIndices:l.indices.map(d=>d==null?{start:tt,end:tt,length:0}:{start:d[0]+c,end:d[1]+c,length:d[1]-d[0]})}}for(let i=0;i<this.regexps.length;i++){const l=this.regexps[i];if(l)try{l.lastIndex=t;const c=l.exec(o);if(!c)continue;if(c.index===t)return a(i,c,0);s.push([i,c,0])}catch(c){if(this.options.forgiving)continue;throw c}}if(s.length){const i=Math.min(...s.map(l=>l[1].index));for(const[l,c,d]of s)if(c.index===i)return a(l,c,d)}return null}}function In(e,r){return $n(e,{global:!0,hasIndices:!0,lazyCompileLength:3e3,rules:{allowOrphanBackrefs:!0,asciiWordBoundaries:!0,captureGroup:!0,recursionLimit:5,singleline:!0},...r})}function Sn(e={}){const r=Object.assign({target:"auto",cache:new Map},e);return r.regexConstructor||=t=>In(t,{target:r.target}),{createScanner(t){return new _n(t,r)},createString(t){return{content:t}}}}const Mn=St(()=>st(()=>import("./C7ZXW3lA.js"),[],import.meta.url)),Nn=St(async e=>{const[{createHighlighterCore:r},t]=await Promise.all([Mn(),e]),n=await r({...t.core,engine:Sn()});return n.highlight=(o,s)=>Pn(o,s,n,t),n},e=>{const r=globalThis.__nuxt_shiki_cache??={},t=e[1]||"default";return r[t]??={}});function Pn(e,r,t,n){return t.codeToHtml(e,{...n.highlight,...r,lang:r.lang||n.highlight.lang,transformers:[...r.unwrap?[Vt]:[],...r.transformers||[]]})}function St(e,r){const t=r?void 0:{};return function(...n){const o=t||r(n);if(o.value!==void 0)return o.value;if(o.promise)return o.promise;const s=e(...n);return s instanceof Promise&&(o.promise=s.then(a=>(o.value=a,delete o.promise,a))),o.promise}}async function Ln(){return Nn(st(()=>import("./5FxZUztb.js"),[],import.meta.url).then(e=>e.shikiOptions),"_internal")}const Fn={class:"max-w-3xl mx-auto"},Gn={class:"space-y-4 md:space-y-6"},Rn={class:"relative text-sm"},Un={key:0,class:"material-icons-outlined"},Tn={key:1,class:"material-icons-outlined"},Dn=["innerHTML"],On={class:"relative text-sm"},Bn={key:0,class:"material-icons-outlined"},Vn={key:1,class:"material-icons-outlined"},Hn=["innerHTML"],zn={class:"space-y-4 md:space-y-6"},jn={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},Wn=["aria-label","onClick"],Xn=["src"],Zn={key:0,class:"text-center"},qn={class:"max-w-3xl mx-auto mt-12"},Qn={class:"bg-white rounded-md shadow-lg w-full max-w-md p-6 relative m-4"},Jn={class:"space-y-5"},Kn=["src"],Yn={class:"text-2xl font-medium text-center"},es={class:"grid grid-cols-[50px_1fr] gap-x-4 gap-y-2 text-sm md:text-base"},ts={class:"text-gray-600"},rs={class:"text-gray-600"},rt=`import { ref, onMounted, onUnmounted } from 'vue';

const providers = ref([]);

const eip6963Handler = (event) => {
  const provider = event.detail;
  if (
    provider &&
    !providers.value.find((p) => p.info.uuid === provider.info.uuid)
  ) {
    providers.value.push(provider);
  }
};

onMounted(() => {
  window.addEventListener("eip6963:announceProvider", eip6963Handler);
  window.dispatchEvent(new Event("eip6963:requestProvider"));
});

onUnmounted(() => {
  window.removeEventListener("eip6963:announceProvider", eip6963Handler);
});
`,nt=`<template>
  <div
    v-for="provider in providers"
    :key="provider.info.name"
  >
    <img :src="provider.info.icon" />
    {{ provider.info.name }}
  </div>
</template>`,os={__name:"how-to-implement-multi-injected-provider-discovery-eip-6963",setup(e){const r=j([]),t=j(null),n=j(!1),o=j(!1),s=j(""),a=j(""),i=(p,u)=>{navigator.clipboard.writeText(p).then(()=>{u==="script"&&(n.value=!0),u==="template"&&(o.value=!0),setTimeout(()=>{u==="script"&&(n.value=!1),u==="template"&&(o.value=!1)},2e3)})},l=p=>t.value=p,c=()=>window.scrollTo({top:0,behavior:"smooth"}),d=p=>{const u=p.detail;u&&!r.value.find(g=>g.info.uuid===u.info.uuid)&&r.value.push(u)};return Ft(t,p=>document.body.style=p?"overflow: hidden":""),Gt(async()=>{window.addEventListener("eip6963:announceProvider",d),window.dispatchEvent(new Event("eip6963:requestProvider"));const p=await Ln();s.value=p.highlight(rt,{lang:"js"}),a.value=p.highlight(nt,{lang:"vue"})}),Rt(()=>{window.removeEventListener("eip6963:announceProvider",d)}),(p,u)=>{const g=Pt;return P(),N("div",null,[m("article",Fn,[u[11]||(u[11]=m("img",{src:Bt,class:"w-full aspect-16/9 mx-auto"},null,-1)),u[12]||(u[12]=m("h2",{class:"text-2xl md:text-3xl lg:text-4xl my-5 md:my-8 lg:my-10 font-bold text-neutral-800"}," How to implement Multi Injected Provider Discovery | EIP-6963 ",-1)),m("div",Gn,[u[7]||(u[7]=Pe('<p class="text-lg/relaxed text-neutral-700"><a class="font-semibold text-pink hover:text-dark-blue transition-all duration-300 underline decoration-pink hover:decoration-dark-blue" href="https://eips.ethereum.org/EIPS/eip-6963" target="_blank" rel="noopener noreferrer">EIP-6963</a> is an Ethereum Improvement Proposal that defines a <strong class="font-semibold text-neutral-800">standard interface for Ethereum provider detection in browsers</strong>. This solves a common problem: dApps often cannot reliably detect which wallets a user has installed, which can lead to inconsistent UX or failed connections. It allows dApps to discover which wallet providers (like MetaMask, Coinbase Wallet, or others) are available on a user’s browser without relying on custom scripts. </p><p class="text-lg/relaxed text-neutral-700"> Here’s why adopting EIP-6963 improves your dApp experience: </p><ul class="text-lg/relaxed text-neutral-700 list-disc ml-10 space-y-3 marker:text-gray-300"><li><strong class="font-semibold text-neutral-800">dApps</strong> can automatically show a list of providers a user has installed </li><li> makes <strong class="font-semibold text-neutral-800">wallet detection</strong> more consistent and secure </li><li> avoids relying on <strong class="font-semibold text-neutral-800">window.ethereum</strong> heuristics, which may be unreliable </li><li> ensures <strong class="font-semibold text-neutral-800">future compatibility</strong> as new wallet providers adopt the standard. </li></ul><p class="text-lg/relaxed text-neutral-700"> Let&#39;s look at a simple example in Vue.js. </p>',4)),m("div",Rn,[m("button",{class:"absolute right-2 top-2 bg-gray-600 text-white px-2 rounded-md cursor-pointer py-2 flex items-center justify-center h-10 w-10",onClick:u[0]||(u[0]=f=>i(rt,"script")),"aria-label":"Copy code snippet to clipboard"},[S(n)?(P(),N("span",Un,"check")):(P(),N("span",Tn,"content_copy"))]),m("div",{innerHTML:S(s),class:"p-4 bg-[#272822] rounded-md overflow-auto"},null,8,Dn)]),u[8]||(u[8]=Pe('<p class="text-lg/relaxed text-neutral-700"> The method relies on two events: </p><ul class="text-lg/relaxed text-neutral-700 list-disc ml-10 space-y-3 marker:text-gray-300"><li><strong class="font-semibold text-neutral-800">eip6963:announceProvider</strong> - emitted by a provider when it becomes available </li><li><strong class="font-semibold text-neutral-800">eip6963:requestProvider</strong> - sent to request all available providers to announce themselves. </li></ul><p class="text-lg/relaxed text-neutral-700"> With the list of providers collected, the app can display them for selection or allow login via the chosen provider. </p>',3)),m("div",On,[m("button",{class:"absolute right-2 top-2 bg-gray-600 text-white px-2 rounded-md cursor-pointer py-2 flex items-center justify-center h-10 w-10",onClick:u[1]||(u[1]=f=>i(nt,"template")),"aria-label":"Copy code snippet to clipboard"},[S(o)?(P(),N("span",Bn,"check")):(P(),N("span",Vn,"content_copy"))]),m("div",{innerHTML:S(a),class:"p-4 bg-[#272822] rounded-md overflow-auto"},null,8,Hn)]),u[9]||(u[9]=m("p",{class:"text-lg/relaxed text-neutral-700"},"Useful links:",-1)),u[10]||(u[10]=m("ul",{class:"text-lg/relaxed text-neutral-700 list-disc ml-10 space-y-3 marker:text-gray-300"},[m("li",null,[m("a",{href:"https://eips.ethereum.org/EIPS/eip-6963",target:"_blank",rel:"noopener noreferrer",class:"text-pink hover:text-dark-blue transition-all duration-300 underline decoration-pink hover:decoration-dark-blue"},"EIP-6963 specification")])],-1)),m("div",zn,[u[4]||(u[4]=m("div",{class:"my-8 h-0.5 bg-gradient-to-r from-pink to-dark-blue"},null,-1)),u[5]||(u[5]=m("p",{class:"text-lg/relaxed text-neutral-700 font-semibold"}," Live demo ",-1)),u[6]||(u[6]=m("p",{class:"text-lg/relaxed text-neutral-700"}," Detected providers appear below. Click one to select it and update the app state. ",-1)),m("div",jn,[(P(!0),N(Ut,null,Tt(S(r),f=>(P(),N("button",{key:f.info.name,class:"flex items-center justify-center border border-black w-full p-2 cursor-pointer","aria-label":`Select ${f.info.name} wallet`,onClick:w=>l(f)},[m("img",{src:f.info.icon,class:"h-8 mr-2"},null,8,Xn),Ge(" "+ne(f.info.name),1)],8,Wn))),128))]),S(r).length===0?(P(),N("p",Zn," No providers detected. Consider guiding the user to install a compatible wallet to start interacting with the dApp. ")):Le("",!0)])])]),m("nav",qn,[Ne(g,{to:"/",class:"inline-block text-white py-2 px-4 bg-gradient-brand text-center shadow"},{default:Fe(()=>[...u[13]||(u[13]=[Ge(" Back to list ",-1)])]),_:1}),m("button",{onClick:c,class:"fixed right-4 bottom-4 w-12 h-12 rounded-full bg-gradient-brand text-white flex items-center justify-center shadow-lg z-50 cursor-pointer","aria-label":"Back to top"},[...u[14]||(u[14]=[m("span",{class:"material-icons-outlined"},"expand_less",-1)])])]),Ne(Dt,null,{default:Fe(()=>[S(t)?(P(),N("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/80",onClick:u[3]||(u[3]=Ot(f=>t.value=null,["self"]))},[m("div",Qn,[m("button",{class:"absolute top-4 right-4 text-gray-600 hover:text-gray-300 cursor-pointer","aria-label":"Close modal",onClick:u[2]||(u[2]=f=>t.value=null)},[...u[15]||(u[15]=[m("span",{class:"material-icons-outlined"},"close",-1)])]),m("div",Jn,[u[18]||(u[18]=m("h2",{class:"text-lg font-semibold mb-4"},"Provider details",-1)),m("img",{src:S(t).info.icon,class:"h-24 w-24 p-1 mx-auto"},null,8,Kn),m("p",Yn,ne(S(t).info.name),1),m("div",es,[u[16]||(u[16]=m("div",{class:"font-semibold text-gray-600"},"Rdns:",-1)),m("div",ts,ne(S(t).info.rdns),1),u[17]||(u[17]=m("div",{class:"font-semibold text-gray-600"},"Uuid:",-1)),m("div",rs,ne(S(t).info.uuid),1)])])])])):Le("",!0)]),_:1})])}}};export{os as default};
